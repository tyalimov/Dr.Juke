#include <windows.h>
#include <wintrust.h>
#include <memory>

<<<<<<< HEAD
#include <winlib/raii.h>
=======
#include <tasklib/tasklib.h>
#include <common/constants.h>

using namespace drjuke::scansvc;
using namespace drjuke::threading;
>>>>>>> tyalimov_dev_tasklib_2


int main()
{
<<<<<<< HEAD
    drjuke::winlib::UniqueHandle t(CreateFileW
    (
        L"123", 
        GENERIC_WRITE, 
        0, 
        NULL,
        CREATE_ALWAYS, 
        FILE_ATTRIBUTE_NORMAL, 
        NULL
    ));

=======
    UNREFERENCED_PARAMETER(argc);
    UNREFERENCED_PARAMETER(argv);

    const std::vector<IAnalyzerPtr> kAnalyzers
    {
        std::make_shared<YaraAnalyzer>()
    };

    try
    {
        for (auto &analyzer : kAnalyzers)
        {
            analyzer->loadResources();
            
            std::cout << "Analyzer - [" << analyzer->getName() << "]\n";
            std::cout << analyzer->getReport(argv[1])->toJson().dump() << "\n\n";
        }
    }
    catch (const std::exception &ex)
    {
        std::cout << ex.what() << std::endl;
    }

    return 0;
>>>>>>> tyalimov_dev_tasklib_2
}